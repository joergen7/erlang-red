[{"id":"b4951675b6a39a5d","type":"tab","label":"[.core] (jsonata) $privdir operator","disabled":false,"info":"## $privdir - obtain /priv directory for application\n\nErlang-Red only test which ensures that the JSONata operator `$privdir(...)` works.\n\nThe operator is given the name of an application and it returns the location of the full qualified location of the priv directory for the application.\n\n","env":[{"name":"ERLANG_RED_ONLY","type":"bool","value":"true"}]},{"id":"ab1ac53186371dce","type":"inject","z":"b4951675b6a39a5d","name":"using application name","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"$privdir(erlang_red)","payloadType":"jsonata","x":466,"y":364,"wires":[["5842c3576c97e234"]]},{"id":"5842c3576c97e234","type":"ut-assert-values","z":"b4951675b6a39a5d","name":"priv path has no trailing '/'","ignore_failure_if_succeed":false,"rules":[{"p":"payload","pt":"msg","t":"mth","to":"erlang_red/priv","tot":"str"}],"x":1001,"y":363.5,"wires":[[]]},{"id":"8123dd789bc78dd6","type":"inject","z":"b4951675b6a39a5d","name":"using application name and string concat","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"\"/start/here/\" & $privdir(erlang_red) & \"/hello/world\"","payloadType":"jsonata","x":526,"y":484,"wires":[["34b36c1942af2fc2"]]},{"id":"34b36c1942af2fc2","type":"ut-assert-values","z":"b4951675b6a39a5d","name":"appending slash and path","ignore_failure_if_succeed":false,"rules":[{"p":"payload","pt":"msg","t":"mth","to":"erlang_red/priv/hello/world","tot":"str"},{"p":"payload","pt":"msg","t":"mth","to":"","tot":"str"}],"x":1001,"y":483.5,"wires":[[]]},{"id":"458b70f0796a0e98","type":"inject","z":"b4951675b6a39a5d","name":"variable reference should also work","props":[{"p":"app","v":"{\"name\":\"erlang_red\"}","vt":"json"},{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"$privdir($$.app.name)","payloadType":"jsonata","x":506,"y":602.5,"wires":[["32ca8ac19bf4debf"]]},{"id":"32ca8ac19bf4debf","type":"ut-assert-values","z":"b4951675b6a39a5d","name":"priv path has no trailing '/'","ignore_failure_if_succeed":false,"rules":[{"p":"payload","pt":"msg","t":"mth","to":"erlang_red/priv","tot":"str"}],"x":1001,"y":602.5,"wires":[[]]},{"id":"85ac7518f95c8606","type":"inject","z":"b4951675b6a39a5d","name":"using non-existent application name","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"$privdir(does_not_exist)","payloadType":"jsonata","x":496,"y":717,"wires":[["c7ec74399f795dd8"]]},{"id":"c7ec74399f795dd8","type":"ut-assert-values","z":"b4951675b6a39a5d","name":"priv path has no trailing '/'","ignore_failure_if_succeed":false,"rules":[{"t":"eql","p":"payload","pt":"msg","to":"[\"error\",\"bad_name\"]","tot":"json"}],"x":1000,"y":716.5,"wires":[[]]}]
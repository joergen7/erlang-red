[{"id":"c4b44f0eb78bc401","type":"tab","label":"[statemachine] combined with supervisor","disabled":false,"info":"## State & Super\n\nEnsure that state machines are compatiable with supervisors and that they behaviour correctly.\n\nThis includes:\n\n- handling cleaning up when the statemachine node is killed by a supervisor, i.e. killing the statemachine process --> <a class=\"ahl-group-only\" data-ids=\"3e66f8d35dcccd45\">test two</a>\n\n- being revived when the state machine dies, that is, state machine dies and the state machine node dies and the supervisor revives the state machine node and that should revive the state machein process.\n\n- one for one strategy --> <a class=\"ahl-group-only\" data-ids=\"08b624e4776271aa\">test one - state machine does not go down - one-for-one supervisor strategy</a> --> nothing happens to the <a class=\"ahl-node-only\" data-ids=\"8fe56bff6d1168df\">statemachine</a>.\n\n## Children Shutdown Modus\n\n**Important**: for the restart of state machine to work, in <a class=\"ahl-group-only\" data-ids=\"3e66f8d35dcccd45\">test two</a>, the supervisor children configuration **must** have shutdown method \"infinite timeout\". This allows the <a class=\"ahl-node-only\" data-ids=\"568af3c792b45e1c\">statemachine node</a> to shutdown the state machine process - cleaning up the BEAM. Why? Because a \"brutal kill\" cannot be trapped by a process.\n\n\n\n","env":[{"name":"ERED_TIMEOUT","type":"num","value":"5"},{"name":"ERED_NOT_EUNIT","type":"bool","value":"true"}]},{"id":"08b624e4776271aa","type":"group","z":"c4b44f0eb78bc401","name":"test one - state machine does not go down - one-for-one supervisor strategy","style":{"label":true},"nodes":["20e72ff5bec936c8","40364d3053b8a4e0","bc4da59c2e1cb9bc","5d5ed051fcaa2ecb","5dd1a7202841bf5d","eb32759f57580b45","76eed69af6441b74","25b62620c84cb22a","66704de95c639175"],"x":114,"y":324.25,"w":1092,"h":334.5},{"id":"3e66f8d35dcccd45","type":"group","z":"c4b44f0eb78bc401","name":"test two - state machine goes down - one-for-all supervisor strategy - state machine killed by supervisor","style":{"label":true},"nodes":["10fc93b29d5a1f22","d70e1e108112879f","11eb87972a6a8401","00ceb0e4c309bcc0","bf5bf62875acb4d1","e86c227ffa1a83c1","57691c2b624686d6","dc5aaefd109f64b8","5c1cf21f1fb90b33","1861361a9b4d5f62"],"x":112,"y":667,"w":1141,"h":351.5},{"id":"d2676ea9167d324a","type":"group","z":"c4b44f0eb78bc401","name":"test three - the supervisor is supervising the statemachine and the function and the statemachine fails.","style":{"label":true},"nodes":["c3f4e859ea635735","ab9e3c02f592be5f","922575bcd135e60a","a7096bb288094a00","138da3cc8b3a5ef2","d67a25d2557a1e2e","9cbbda083db5e174","e722e21ca68b132e","df523afeb5785abf","95e212a09cd39440","88d7a99d7401a6a0","844aa3a663770ac4"],"x":120,"y":1095.75,"w":1386,"h":350.5},{"id":"1e2c15f3663b1ddf","type":"group","z":"c4b44f0eb78bc401","name":"test four - statemachine fails with normal exit","style":{"label":true},"nodes":["14b5e2359330d122","84349711621b08b0","1728ae931f30d5f5","1b1d1202ed8df0ed","d160ea17dd78978c","92637e18abd99338","570597bf2bf59936","9f5a6a1945981be0","bde58c5a6e47081b","f395f550175a280b","fa00d7b8e1cb762b","9cfc4bb157d64010"],"x":120,"y":1500.25,"w":1331,"h":350.5},{"id":"478d0fb57ab7d26d","type":"group","z":"c4b44f0eb78bc401","name":"test five - statemachine fails with normal exit, one-for-one strategy","style":{"label":true},"nodes":["0b25fc06966958fd","3e782403e4a4fe50","47e1ec98f2567c9b","7cba9db5d7e7e3c9","5ccb66cdda997756","fcd545792fb1dbb6","daca7c01dc91e4e7","fc9065798f097ae2","70f0700ec9a636a5","22bfc5f4e5b9bdc4","983328e8927c62af","0fd9635e00752157"],"x":120,"y":1944.25,"w":1331,"h":350.5},{"id":"1861361a9b4d5f62","type":"group","z":"c4b44f0eb78bc401","g":"3e66f8d35dcccd45","style":{"color":"#a4a4a4","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","stroke":"#999999","stroke-opacity":"1"},"nodes":["e22cb2d8aec50247","25d71387cf585773","568af3c792b45e1c"],"x":640,"y":693,"w":332,"h":299.5},{"id":"66704de95c639175","type":"group","z":"c4b44f0eb78bc401","g":"08b624e4776271aa","style":{"color":"#a4a4a4","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","stroke":"#999999","stroke-opacity":"1"},"nodes":["49e5fefe075897e0","fe2ca5841d3358d5","8fe56bff6d1168df"],"x":613,"y":350.25,"w":332,"h":282.5},{"id":"ab9e3c02f592be5f","type":"group","z":"c4b44f0eb78bc401","g":"d2676ea9167d324a","style":{"color":"#a4a4a4","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","stroke":"#999999","stroke-opacity":"1"},"nodes":["5c3243ee3bfaaaad","8478146988a90e12","3c709ae77828708a"],"x":589.5,"y":1121.75,"w":412,"h":298.5},{"id":"1728ae931f30d5f5","type":"group","z":"c4b44f0eb78bc401","g":"1e2c15f3663b1ddf","style":{"color":"#a4a4a4","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","stroke":"#999999","stroke-opacity":"1"},"nodes":["bc0212efedef16b2","4e1f4a4569ce4d4b","936910fd837b5872"],"x":547,"y":1526.25,"w":412,"h":298.5},{"id":"47e1ec98f2567c9b","type":"group","z":"c4b44f0eb78bc401","g":"478d0fb57ab7d26d","style":{"color":"#a4a4a4","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","stroke":"#999999","stroke-opacity":"1"},"nodes":["b2c917d9ee5e37f3","816b5bbd671aef30","57f85cfe0d93761f"],"x":547,"y":1970.25,"w":412,"h":298.5},{"id":"76eed69af6441b74","type":"junction","z":"c4b44f0eb78bc401","g":"08b624e4776271aa","x":519,"y":591.75,"wires":[["fe2ca5841d3358d5","8fe56bff6d1168df"]]},{"id":"57691c2b624686d6","type":"junction","z":"c4b44f0eb78bc401","g":"3e66f8d35dcccd45","x":566,"y":951.5,"wires":[["25d71387cf585773","568af3c792b45e1c"]]},{"id":"c3f4e859ea635735","type":"junction","z":"c4b44f0eb78bc401","g":"d2676ea9167d324a","x":495.5,"y":1379.25,"wires":[["8478146988a90e12","3c709ae77828708a"]]},{"id":"14b5e2359330d122","type":"junction","z":"c4b44f0eb78bc401","g":"1e2c15f3663b1ddf","x":473,"y":1783.75,"wires":[["4e1f4a4569ce4d4b","936910fd837b5872"]]},{"id":"9f5a6a1945981be0","type":"junction","z":"c4b44f0eb78bc401","g":"1e2c15f3663b1ddf","x":280.57141971588135,"y":1791.3235076665878,"wires":[["570597bf2bf59936"]]},{"id":"0b25fc06966958fd","type":"junction","z":"c4b44f0eb78bc401","g":"478d0fb57ab7d26d","x":473,"y":2227.75,"wires":[["816b5bbd671aef30","57f85cfe0d93761f"]]},{"id":"fc9065798f097ae2","type":"junction","z":"c4b44f0eb78bc401","g":"478d0fb57ab7d26d","x":280.57141971588135,"y":2235.323507666588,"wires":[["daca7c01dc91e4e7"]]},{"id":"d67a25d2557a1e2e","type":"junction","z":"c4b44f0eb78bc401","g":"d2676ea9167d324a","x":321.57141971588135,"y":1380.3235076665878,"wires":[["138da3cc8b3a5ef2","c3f4e859ea635735"]]},{"id":"49e5fefe075897e0","type":"erlsupervisor","z":"c4b44f0eb78bc401","g":"66704de95c639175","name":"supervisor - one for one","scope":["fe2ca5841d3358d5","8fe56bff6d1168df"],"supervisor_type":"static","strategy":"one_for_one","auto_shutdown":"never","intensity":"3","period":"10","child_type":"worker","child_restart":"permanent","child_shutdown":"brutal_kill","child_shutdown_timeout":"0","x":755,"y":391.25,"wires":[[]]},{"id":"fe2ca5841d3358d5","type":"function","z":"c4b44f0eb78bc401","g":"66704de95c639175","name":"divide by zero exception","func":"    1 / 0\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":752,"y":591.75,"wires":[["eb32759f57580b45"]]},{"id":"8fe56bff6d1168df","type":"erlstatemachine","z":"c4b44f0eb78bc401","g":"66704de95c639175","name":"","scope":["9403ad72c9007c0a"],"emit_on_state_change":false,"x":779,"y":488,"wires":[["40364d3053b8a4e0"]]},{"id":"9403ad72c9007c0a","type":"erlmodule","z":"c4b44f0eb78bc401","name":"","module_name":"statemachine_and_supervisor","code":"-module(statemachine_and_supervisor).\n\n-behaviour(gen_statem).\n\n-export([\n    start/0,\n    init/1,\n    callback_mode/0,\n    handle_event/4,\n    code_change/4,\n    terminate/3,\n    stop/0\n]).\n\ncallback_mode() -> handle_event_function.\n\n%% API.  This example uses a registered name name()\n%% and does not link to the caller.\nstart() ->\n    gen_statem:start({local, ?MODULE}, ?MODULE, [], []).\n\ninit([]) ->\n    State = disconnected,\n    Data = 0,\n    {ok, State, Data}.\n\n%% Mandatory callback functions\nstop() ->\n    gen_statem:stop(?MODULE).\nterminate(_Reason, _State, _Data) ->\n    void.\ncode_change(_Vsn, State, Data, _Extra) ->\n    {ok,State,Data}.\n\n%%\n%% handler function for state transistions\n%%\n\n%%\n%% Do not much. Increment counter and return the value on each call.\n%%\nhandle_event(\n  {call, From},\n  {<<\"donothing\">>, <<\"donothing\">>},\n  disconnected,\n  Data\n) ->\n    {keep_state, \n        Data+1, \n            [{reply, \n              From, \n              list_to_binary(io_lib:format(\"count ~p\", [Data+1]))\n              }\n            ]}.\n\n","x":182,"y":128,"wires":[]},{"id":"20e72ff5bec936c8","type":"inject","z":"c4b44f0eb78bc401","g":"08b624e4776271aa","name":"","props":[{"p":"payload"},{"p":"action","v":"donothing","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"donothing","payloadType":"str","x":223,"y":589,"wires":[["76eed69af6441b74"]]},{"id":"c2fe41f90a2e86c9","type":"erlmodule","z":"c4b44f0eb78bc401","name":"","module_name":"statemachine_and_supervisor_exit_failure","code":"-module(statemachine_and_supervisor_exit_failure).\n\n-behaviour(gen_statem).\n\n-export([\n    start/0,\n    init/1,\n    callback_mode/0,\n    handle_event/4,\n    code_change/4,\n    terminate/3,\n    stop/0\n]).\n\ncallback_mode() -> handle_event_function.\n\n%% API.  This example uses a registered name name()\n%% and does not link to the caller.\nstart() ->\n    gen_statem:start({local, ?MODULE}, ?MODULE, [], []).\n\ninit([]) ->\n    State = disconnected,\n    Data = 0,\n    {ok, State, Data}.\n\n%% Mandatory callback functions\nstop() ->\n    gen_statem:stop(?MODULE).\nterminate(_Reason, _State, _Data) ->\n    void.\ncode_change(_Vsn, State, Data, _Extra) ->\n    {ok,State,Data}.\n\n%%\n%% handler function for state transistions\n%%\n\n%%\n%% Do not much.\n%%\nhandle_event(\n  {call, From},\n  {<<\"donothing\">>, <<\"donothing\">>},\n  disconnected,\n  Data\n) ->\n    case Data of \n        3 -> \n            exit(self(), failure);\n        _ ->\n            ignore\n    end,\n    {keep_state, \n        Data+1, \n            [{reply, \n              From, \n              list_to_binary(io_lib:format(\"count ~p\", [Data+1]))\n              }\n            ]}.\n            ","x":223,"y":194,"wires":[]},{"id":"40364d3053b8a4e0","type":"ut-assert-values","z":"c4b44f0eb78bc401","g":"08b624e4776271aa","name":"","ignore_failure_if_succeed":true,"rules":[{"p":"payload","pt":"msg","t":"eql","to":"count 5","tot":"str"}],"x":1090,"y":487.5,"wires":[[]]},{"id":"bc4da59c2e1cb9bc","type":"inject","z":"c4b44f0eb78bc401","g":"08b624e4776271aa","name":"","props":[{"p":"payload"},{"p":"action","v":"donothing","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"donothing","payloadType":"str","x":223,"y":547.3333333333334,"wires":[["76eed69af6441b74"]]},{"id":"5d5ed051fcaa2ecb","type":"inject","z":"c4b44f0eb78bc401","g":"08b624e4776271aa","name":"","props":[{"p":"payload"},{"p":"action","v":"donothing","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"donothing","payloadType":"str","x":223,"y":505.6666666666667,"wires":[["76eed69af6441b74"]]},{"id":"5dd1a7202841bf5d","type":"inject","z":"c4b44f0eb78bc401","g":"08b624e4776271aa","name":"","props":[{"p":"payload"},{"p":"action","v":"donothing","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"donothing","payloadType":"str","x":223,"y":464,"wires":[["76eed69af6441b74"]]},{"id":"eb32759f57580b45","type":"ut-assert-failure","z":"c4b44f0eb78bc401","g":"08b624e4776271aa","name":"","x":1077,"y":591.75,"wires":[]},{"id":"25b62620c84cb22a","type":"inject","z":"c4b44f0eb78bc401","g":"08b624e4776271aa","name":"","props":[{"p":"payload"},{"p":"action","v":"donothing","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"donothing","payloadType":"str","x":220,"y":423,"wires":[["76eed69af6441b74"]]},{"id":"e22cb2d8aec50247","type":"erlsupervisor","z":"c4b44f0eb78bc401","g":"1861361a9b4d5f62","name":"supervisor - one for all","scope":["25d71387cf585773","568af3c792b45e1c"],"supervisor_type":"static","strategy":"one_for_all","auto_shutdown":"never","intensity":"3","period":"10","child_type":"worker","child_restart":"permanent","child_shutdown":"infinite","child_shutdown_timeout":"0","x":803,"y":734,"wires":[[]]},{"id":"25d71387cf585773","type":"function","z":"c4b44f0eb78bc401","g":"1861361a9b4d5f62","name":"exit self failure","func":"exit(self(), failure)","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":769,"y":951.5,"wires":[["e86c227ffa1a83c1"]]},{"id":"568af3c792b45e1c","type":"erlstatemachine","z":"c4b44f0eb78bc401","g":"1861361a9b4d5f62","name":"","scope":["9403ad72c9007c0a"],"emit_on_state_change":false,"x":806,"y":847.75,"wires":[["d70e1e108112879f"]]},{"id":"10fc93b29d5a1f22","type":"inject","z":"c4b44f0eb78bc401","g":"3e66f8d35dcccd45","name":"","props":[{"p":"payload"},{"p":"action","v":"donothing","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"donothing","payloadType":"str","x":221,"y":949.75,"wires":[["5c1cf21f1fb90b33"]]},{"id":"d70e1e108112879f","type":"ut-assert-values","z":"c4b44f0eb78bc401","g":"3e66f8d35dcccd45","name":"","ignore_failure_if_succeed":false,"rules":[{"p":"payload","pt":"msg","t":"eql","to":"count 1","tot":"str"}],"x":1137,"y":847.25,"wires":[[]]},{"id":"11eb87972a6a8401","type":"inject","z":"c4b44f0eb78bc401","g":"3e66f8d35dcccd45","name":"","props":[{"p":"payload"},{"p":"action","v":"donothing","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"donothing","payloadType":"str","x":221,"y":908.0833333333334,"wires":[["5c1cf21f1fb90b33"]]},{"id":"00ceb0e4c309bcc0","type":"inject","z":"c4b44f0eb78bc401","g":"3e66f8d35dcccd45","name":"","props":[{"p":"payload"},{"p":"action","v":"donothing","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"donothing","payloadType":"str","x":221,"y":866.4166666666667,"wires":[["5c1cf21f1fb90b33"]]},{"id":"bf5bf62875acb4d1","type":"inject","z":"c4b44f0eb78bc401","g":"3e66f8d35dcccd45","name":"","props":[{"p":"payload"},{"p":"action","v":"donothing","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"donothing","payloadType":"str","x":221,"y":824.75,"wires":[["5c1cf21f1fb90b33"]]},{"id":"e86c227ffa1a83c1","type":"ut-assert-failure","z":"c4b44f0eb78bc401","g":"3e66f8d35dcccd45","name":"","x":1124,"y":951.5,"wires":[]},{"id":"dc5aaefd109f64b8","type":"inject","z":"c4b44f0eb78bc401","g":"3e66f8d35dcccd45","name":"","props":[{"p":"payload"},{"p":"action","v":"donothing","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"donothing","payloadType":"str","x":218,"y":783.75,"wires":[["5c1cf21f1fb90b33"]]},{"id":"5c1cf21f1fb90b33","type":"delay","z":"c4b44f0eb78bc401","g":"3e66f8d35dcccd45","name":"","pauseType":"random","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"0.5","randomLast":"3","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":439,"y":783,"wires":[["57691c2b624686d6"]]},{"id":"5c3243ee3bfaaaad","type":"erlsupervisor","z":"c4b44f0eb78bc401","g":"ab9e3c02f592be5f","name":"supervisor - one for all","scope":["8478146988a90e12","3c709ae77828708a"],"supervisor_type":"static","strategy":"one_for_all","auto_shutdown":"never","intensity":"3","period":"10","child_type":"worker","child_restart":"permanent","child_shutdown":"infinite","child_shutdown_timeout":"0","x":746.5,"y":1162.75,"wires":[[]]},{"id":"8478146988a90e12","type":"function","z":"c4b44f0eb78bc401","g":"ab9e3c02f592be5f","name":"pass through the message","func":"Msg","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":738.5,"y":1379.25,"wires":[["922575bcd135e60a"]]},{"id":"3c709ae77828708a","type":"erlstatemachine","z":"c4b44f0eb78bc401","g":"ab9e3c02f592be5f","name":"","scope":["c2fe41f90a2e86c9"],"emit_on_state_change":false,"x":795.5,"y":1275.5,"wires":[["9cbbda083db5e174","df523afeb5785abf","88d7a99d7401a6a0"]]},{"id":"922575bcd135e60a","type":"debug","z":"c4b44f0eb78bc401","g":"d2676ea9167d324a","name":"debug 1","active":true,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","statusVal":"","statusType":"counter","x":1096,"y":1379,"wires":[]},{"id":"84349711621b08b0","type":"inject","z":"c4b44f0eb78bc401","g":"1e2c15f3663b1ddf","name":"","props":[{"p":"payload"},{"p":"action","v":"donothing","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"donothing","payloadType":"str","x":226,"y":1569,"wires":[["570597bf2bf59936"]]},{"id":"bc0212efedef16b2","type":"erlsupervisor","z":"c4b44f0eb78bc401","g":"1728ae931f30d5f5","name":"supervisor - one for all","scope":["4e1f4a4569ce4d4b","936910fd837b5872"],"supervisor_type":"static","strategy":"one_for_all","auto_shutdown":"never","intensity":"10","period":"10","child_type":"worker","child_restart":"permanent","child_shutdown":"infinite","child_shutdown_timeout":"0","x":724,"y":1567.25,"wires":[[]]},{"id":"4e1f4a4569ce4d4b","type":"function","z":"c4b44f0eb78bc401","g":"1728ae931f30d5f5","name":"pass through the message","func":"Msg","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":716,"y":1783.75,"wires":[["1b1d1202ed8df0ed"]]},{"id":"936910fd837b5872","type":"erlstatemachine","z":"c4b44f0eb78bc401","g":"1728ae931f30d5f5","name":"","scope":["e7586b6a24f55cb0"],"emit_on_state_change":false,"x":753,"y":1680,"wires":[["d160ea17dd78978c","bde58c5a6e47081b","fa00d7b8e1cb762b"]]},{"id":"1b1d1202ed8df0ed","type":"debug","z":"c4b44f0eb78bc401","g":"1e2c15f3663b1ddf","name":"debug 3","active":true,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","statusVal":"","statusType":"counter","x":1073.5,"y":1783.5,"wires":[]},{"id":"e7586b6a24f55cb0","type":"erlmodule","z":"c4b44f0eb78bc401","name":"","module_name":"statemachine_and_supervisor_exit_normal","code":"-module(statemachine_and_supervisor_exit_normal).\n\n-behaviour(gen_statem).\n\n-export([\n    start/0,\n    init/1,\n    callback_mode/0,\n    handle_event/4,\n    code_change/4,\n    terminate/3,\n    stop/0\n]).\n\ncallback_mode() -> handle_event_function.\n\n%% API.  This example uses a registered name name()\n%% and does not link to the caller.\nstart() ->\n    gen_statem:start({local, ?MODULE}, ?MODULE, [], []).\n\ninit([]) ->\n    State = disconnected,\n    Data = 0,\n    {ok, State, Data}.\n\n%% Mandatory callback functions\nstop() ->\n    gen_statem:stop(?MODULE).\nterminate(_Reason, _State, _Data) ->\n    void.\ncode_change(_Vsn, State, Data, _Extra) ->\n    {ok,State,Data}.\n\n%%\n%% handler function for state transistions\n%%\n\n%%\n%% Do not much.\n%%\nhandle_event(\n  {call, From},\n  {<<\"donothing\">>, <<\"donothing\">>},\n  disconnected,\n  Data\n) ->\n    case Data of \n        3 -> \n            exit(self(), normal);\n        _ ->\n            ignore\n    end,\n    {keep_state, \n        Data+1, \n            [{reply, \n              From, \n              list_to_binary(io_lib:format(\"count ~p\", [Data+1]))\n              }\n            ]}.\n            ","x":222,"y":252,"wires":[]},{"id":"d160ea17dd78978c","type":"switch","z":"c4b44f0eb78bc401","g":"1e2c15f3663b1ddf","name":"filter all generated values","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"count 1","vt":"str"},{"t":"eq","v":"count 2","vt":"str"},{"t":"eq","v":"count 3","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":4,"x":1133,"y":1594,"wires":[[],[],[],["92637e18abd99338"]]},{"id":"92637e18abd99338","type":"ut-assert-failure","z":"c4b44f0eb78bc401","g":"1e2c15f3663b1ddf","name":"","x":1355,"y":1613.5,"wires":[]},{"id":"570597bf2bf59936","type":"delay","z":"c4b44f0eb78bc401","g":"1e2c15f3663b1ddf","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":278,"y":1658,"wires":[["14b5e2359330d122","9f5a6a1945981be0"]]},{"id":"bde58c5a6e47081b","type":"join","z":"c4b44f0eb78bc401","g":"1e2c15f3663b1ddf","name":"","mode":"custom","build":"array","property":"","propertyType":"full","key":"topic","joiner":"\\n","joinerType":"str","useparts":false,"accumulate":false,"timeout":"","count":"33","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1073,"y":1680,"wires":[["f395f550175a280b"]]},{"id":"f395f550175a280b","type":"ut-assert-success","z":"c4b44f0eb78bc401","g":"1e2c15f3663b1ddf","name":"","x":1288,"y":1679.5,"wires":[]},{"id":"fa00d7b8e1cb762b","type":"join","z":"c4b44f0eb78bc401","g":"1e2c15f3663b1ddf","name":"","mode":"custom","build":"array","property":"","propertyType":"full","key":"topic","joiner":"\\n","joinerType":"str","useparts":false,"accumulate":false,"timeout":"","count":"34","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1072,"y":1738,"wires":[["9cfc4bb157d64010"]]},{"id":"9cfc4bb157d64010","type":"ut-assert-failure","z":"c4b44f0eb78bc401","g":"1e2c15f3663b1ddf","name":"","x":1350,"y":1738,"wires":[]},{"id":"3e782403e4a4fe50","type":"inject","z":"c4b44f0eb78bc401","g":"478d0fb57ab7d26d","name":"","props":[{"p":"payload"},{"p":"action","v":"donothing","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"donothing","payloadType":"str","x":226,"y":2013,"wires":[["daca7c01dc91e4e7"]]},{"id":"b2c917d9ee5e37f3","type":"erlsupervisor","z":"c4b44f0eb78bc401","g":"47e1ec98f2567c9b","name":"supervisor - one for one","scope":["816b5bbd671aef30","57f85cfe0d93761f"],"supervisor_type":"static","strategy":"one_for_one","auto_shutdown":"never","intensity":"10","period":"10","child_type":"worker","child_restart":"permanent","child_shutdown":"infinite","child_shutdown_timeout":"0","x":734,"y":2011.25,"wires":[[]]},{"id":"816b5bbd671aef30","type":"function","z":"c4b44f0eb78bc401","g":"47e1ec98f2567c9b","name":"pass through the message","func":"Msg","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":716,"y":2227.75,"wires":[["7cba9db5d7e7e3c9"]]},{"id":"57f85cfe0d93761f","type":"erlstatemachine","z":"c4b44f0eb78bc401","g":"47e1ec98f2567c9b","name":"","scope":["e7586b6a24f55cb0"],"emit_on_state_change":false,"x":753,"y":2124,"wires":[["5ccb66cdda997756","70f0700ec9a636a5","983328e8927c62af"]]},{"id":"7cba9db5d7e7e3c9","type":"debug","z":"c4b44f0eb78bc401","g":"478d0fb57ab7d26d","name":"debug 4","active":true,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","statusVal":"","statusType":"counter","x":1073.5,"y":2227.5,"wires":[]},{"id":"5ccb66cdda997756","type":"switch","z":"c4b44f0eb78bc401","g":"478d0fb57ab7d26d","name":"filter all generated values","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"count 1","vt":"str"},{"t":"eq","v":"count 2","vt":"str"},{"t":"eq","v":"count 3","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":4,"x":1133,"y":2038,"wires":[[],[],[],["fcd545792fb1dbb6"]]},{"id":"fcd545792fb1dbb6","type":"ut-assert-failure","z":"c4b44f0eb78bc401","g":"478d0fb57ab7d26d","name":"","x":1355,"y":2057.5,"wires":[]},{"id":"daca7c01dc91e4e7","type":"delay","z":"c4b44f0eb78bc401","g":"478d0fb57ab7d26d","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":278,"y":2102,"wires":[["0b25fc06966958fd","fc9065798f097ae2"]]},{"id":"70f0700ec9a636a5","type":"join","z":"c4b44f0eb78bc401","g":"478d0fb57ab7d26d","name":"","mode":"custom","build":"array","property":"","propertyType":"full","key":"topic","joiner":"\\n","joinerType":"str","useparts":false,"accumulate":false,"timeout":"","count":"33","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1073,"y":2124,"wires":[["22bfc5f4e5b9bdc4"]]},{"id":"22bfc5f4e5b9bdc4","type":"ut-assert-success","z":"c4b44f0eb78bc401","g":"478d0fb57ab7d26d","name":"","x":1288,"y":2123.5,"wires":[]},{"id":"983328e8927c62af","type":"join","z":"c4b44f0eb78bc401","g":"478d0fb57ab7d26d","name":"","mode":"custom","build":"array","property":"","propertyType":"full","key":"topic","joiner":"\\n","joinerType":"str","useparts":false,"accumulate":false,"timeout":"","count":"34","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1072,"y":2182,"wires":[["0fd9635e00752157"]]},{"id":"0fd9635e00752157","type":"ut-assert-failure","z":"c4b44f0eb78bc401","g":"478d0fb57ab7d26d","name":"","x":1350,"y":2182,"wires":[]},{"id":"a7096bb288094a00","type":"inject","z":"c4b44f0eb78bc401","g":"d2676ea9167d324a","name":"","props":[{"p":"payload"},{"p":"action","v":"donothing","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"donothing","payloadType":"str","x":226,"y":1173,"wires":[["138da3cc8b3a5ef2"]]},{"id":"138da3cc8b3a5ef2","type":"delay","z":"c4b44f0eb78bc401","g":"d2676ea9167d324a","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":319,"y":1247,"wires":[["d67a25d2557a1e2e"]]},{"id":"9cbbda083db5e174","type":"switch","z":"c4b44f0eb78bc401","g":"d2676ea9167d324a","name":"filter all generated values","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"count 1","vt":"str"},{"t":"eq","v":"count 2","vt":"str"},{"t":"eq","v":"count 3","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":4,"x":1188,"y":1179,"wires":[[],[],[],["e722e21ca68b132e"]]},{"id":"e722e21ca68b132e","type":"ut-assert-failure","z":"c4b44f0eb78bc401","g":"d2676ea9167d324a","name":"","x":1410,"y":1198.5,"wires":[]},{"id":"df523afeb5785abf","type":"join","z":"c4b44f0eb78bc401","g":"d2676ea9167d324a","name":"","mode":"custom","build":"array","property":"","propertyType":"full","key":"topic","joiner":"\\n","joinerType":"str","useparts":false,"accumulate":false,"timeout":"","count":"12","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1128,"y":1265,"wires":[["95e212a09cd39440"]]},{"id":"95e212a09cd39440","type":"ut-assert-success","z":"c4b44f0eb78bc401","g":"d2676ea9167d324a","name":"","x":1343,"y":1264.5,"wires":[]},{"id":"88d7a99d7401a6a0","type":"join","z":"c4b44f0eb78bc401","g":"d2676ea9167d324a","name":"","mode":"custom","build":"array","property":"","propertyType":"full","key":"topic","joiner":"\\n","joinerType":"str","useparts":false,"accumulate":false,"timeout":"","count":"13","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1127,"y":1323,"wires":[["844aa3a663770ac4"]]},{"id":"844aa3a663770ac4","type":"ut-assert-failure","z":"c4b44f0eb78bc401","g":"d2676ea9167d324a","name":"","x":1405,"y":1323,"wires":[]}]